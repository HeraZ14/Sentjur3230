[1mdiff --git a/.ssh/id_rsa b/.ssh/id_rsa[m
[1mnew file mode 100644[m
[1mindex 0000000..6695b69[m
[1m--- /dev/null[m
[1m+++ b/.ssh/id_rsa[m
[36m@@ -0,0 +1,28 @@[m
[32m+[m[32m-----BEGIN OPENSSH PRIVATE KEY-----[m
[32m+[m[32mb3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDjCLrbTU[m
[32m+[m[32mybqb6pUEgbiP9yAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCeno+YUHMx[m
[32m+[m[32mBOB97zWr4233pkaHU4lNmPQlf/JNGxwpriIzvtI5IDgXlxoiDjFUtIM3e59ols/MJWuc7+[m
[32m+[m[32mIVtKwBaSJiDZPseaPa5+HANqp7kvrvZFPbNrSHDmHxpHPxcE96dTVujWMyqwZPNAthDyR+[m
[32m+[m[32mbO+DlVze8Ab95z2oiE3/jrxNvUNgKJgp/74aNnTi9WJkfpR2At1rE4JWOAIZXpWsGKxbag[m
[32m+[m[32mFKXYxE688QpnHAVKTOKHyZMZhkam+3bp94FkOuzZHh4wdla31kBB6AGcAMCQbJZN3NQ8lu[m
[32m+[m[32mpYDJv47xatquHe1SF6Ss+XwMky4apSu0dX9WuuDJWltHgH98yGotAAADwH9EnFvHW624rC[m
[32m+[m[32msYjWacj/OEq01ELmCvdgfG5ZYm5uqtHnzZ6jggPX6CG37+8AqWgcVQO8xR8hSD4AsGMKW6[m
[32m+[m[32mYz6VzthfcgJ+ZTjZR+pz0Mngl1t6/PUfLem3gZA0omU84JLadhIP3is7Zpawbh7v8qBNxA[m
[32m+[m[32mGpAPIfAPOL1Jv8S7pFMAx+QNPD7VpDRW98SJBjq+/rrVzTv+myU8u3sUNfb39dKr3C5bp4[m
[32m+[m[32mBmlL2eNz1EXQBbPjFGuPrZJFCMitTB99lA0+xP3EZfKm0RgVHzOw6/JbNdxbYepWIPUumb[m
[32m+[m[32moEuZNkIrpkyuTN/Z1o8vxUh6TCrR2Mei2M1sciyVMTNeKbVJRGh6GtCx9yFWTg3OV3Ue4F[m
[32m+[m[32mad5FlkbSIqVQFBMhpZQbiRUwBC9Jdw9/KPEJSDBkkIgkpUxqdI2/s/6r7wDGKcKQV9R9kK[m
[32m+[m[32m5FKmLmk63rPVTFhPrVffZDf1ck+8tvkxQZUbu02O93oDhc067Ubvp9WGAdnwNXUoJorsZu[m
[32m+[m[32mhb1pR3pOIzqCDazEKaXq/r7rEVXG6VRzIc8bnAJe4bYkcd76eW1LTVtx/FTJUXt/DYk3Cz[m
[32m+[m[32mBjb/U9adPCMrgRGwMXoB6/LcQnemPJvgs2Vonam0doE24lo/PxKv+I6RvwVqBoazrStAUi[m
[32m+[m[32mfCMeR3nN0JMi3UawBJ4LmPcqD12D2bjYrJouySoSyZyLWYfQuccF092f+LnEsT2SFk9TAe[m
[32m+[m[32mFLTlFCSMTmfUkO6VBIEH9X1fqiM6WPHKGh6QHrfVppibYPQCFHjC0oUdlJPXtGtY5LjskE[m
[32m+[m[32m1fhXgtZufUQhqFbYxnhlBD2a5l+o2U6S4WeKylT2F20jn4rMncMs/XAU2xNHS/3LvRxzRd[m
[32m+[m[32ml+fxvHURpBYVaRly08LoOVWGPfJ5DUj9Dc1lvL6rJBE+by1tsj+zdDEn1oaqu2pf8sr/Zw[m
[32m+[m[32mWXNT2sFcpswss7+CvjzdpBCf1h4/dYxGgTCLE6dIMhF6emR/nO2CunxPd1KYGwkbGTxe1A[m
[32m+[m[32meBD0f1gfWV5R84OU2zEKMZdLW7b6NTmbVRnksadxC+FeMb/ZDg33S0p/gLW0EKOPFwWI34[m
[32m+[m[32mjX5rF8Dex24LfZieRzwIrKqaCrWKWCUYSeSyfmU0NqPHUbhqtprE6XyKdAI1KcLZViRVI8[m
[32m+[m[32mK8rfGMTIWL76kpUQJOwVBAh6uW5VSBXb6TH8w1kPz5Da0RyQhYN8Ljh4EKyDb8V1LAVVN+[m
[32m+[m[32mX2jvfUN4aKCRppuouEmwHeZ9Y4aBfSkAtwHNB2gr0W5LoO5nAvTfiq3amIxx2zfEWOQL32[m
[32m+[m[32mBr6NkUAw==[m
[32m+[m[32m-----END OPENSSH PRIVATE KEY-----[m
[1mdiff --git a/.ssh/id_rsa.pub b/.ssh/id_rsa.pub[m
[1mnew file mode 100644[m
[1mindex 0000000..be7a12b[m
[1m--- /dev/null[m
[1m+++ b/.ssh/id_rsa.pub[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32mssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCeno+YUHMxBOB97zWr4233pkaHU4lNmPQlf/JNGxwpriIzvtI5IDgXlxoiDjFUtIM3e59ols/MJWuc7+IVtKwBaSJiDZPseaPa5+HANqp7kvrvZFPbNrSHDmHxpHPxcE96dTVujWMyqwZPNAthDyR+bO+DlVze8Ab95z2oiE3/jrxNvUNgKJgp/74aNnTi9WJkfpR2At1rE4JWOAIZXpWsGKxbagFKXYxE688QpnHAVKTOKHyZMZhkam+3bp94FkOuzZHh4wdla31kBB6AGcAMCQbJZN3NQ8lupYDJv47xatquHe1SF6Ss+XwMky4apSu0dX9WuuDJWltHgH98yGot[m[41m [m
[1mdiff --git a/Dokumentacija.txt b/Dokumentacija.txt[m
[1mindex 36d1faf..dff93e4 100644[m
[1m--- a/Dokumentacija.txt[m
[1m+++ b/Dokumentacija.txt[m
[36m@@ -24,6 +24,8 @@[m [mpython manage.py makemigrations[m
 python manage.py migrate[m
 python manage.py collectstatic[m
 [m
[32m+[m[32m#datoteke css dodaj tudi v mapi public_html/static/css (urejeno sedaj avtomatsko)[m
[32m+[m
 PUSH NA SERVER:[m
 CMD:[m
 cd C:\cwrsync\bin[m
[36m@@ -36,10 +38,8 @@[m [mrsync -avz --protocol=30 --rsync-path=/usr/bin/rsync ^[m
       sentmet@sentjur-metropola.si:/home/sentmet/Sentjur3230/[m
 [m
 [m
[31m-#datoteke css dodaj tudi v mapi public_html/static/css[m
[31m-[m
 TUNEL:[m
 ssh -p 5050 sentmet@sentjur-metropola.si[m
 [m
[31m-PREVERI ERRORS:[m
[32m+[m[32mPREVERI PROD ERRORS:[m
 python manage.py check --deploy[m
[1mdiff --git a/store/migrations/0034_create_default_product.py b/store/migrations/0034_create_default_product.py[m
[1mnew file mode 100644[m
[1mindex 0000000..cf00856[m
[1m--- /dev/null[m
[1m+++ b/store/migrations/0034_create_default_product.py[m
[36m@@ -0,0 +1,79 @@[m
[32m+[m[32mfrom django.db import migrations, models[m
[32m+[m[32mimport os[m
[32m+[m[32mimport django.db.models.deletion[m
[32m+[m[32mfrom store.models import generate_product_prices[m
[32m+[m[32mimport stripe[m
[32m+[m
[32m+[m
[32m+[m[32madmin_password = os.getenv('DJANGO_ADMIN_PASSWORD', 'admin123')[m
[32m+[m
[32m+[m
[32m+[m[32mdef create_default_product(apps, schema_editor):[m
[32m+[m[32m    User = apps.get_model('auth', 'User')[m
[32m+[m[32m    Product = apps.get_model('store', 'Product')[m
[32m+[m[32m    Category = apps.get_model('store', 'Category')[m
[32m+[m[32m    PriceTypes = apps.get_model('store', 'PriceTypes')[m
[32m+[m[32m    ProductPrice = apps.get_model('store', 'ProductPrice')  # Dodano: za konsistentnost[m
[32m+[m
[32m+[m[32m    if not User.objects.filter(username='admin').exists():[m
[32m+[m[32m        User.objects.create_superuser([m
[32m+[m[32m            username='admin',[m
[32m+[m[32m            email='ziga.heric@gmail.com',[m
[32m+[m[32m            password=admin_password[m
[32m+[m[32m        )[m
[32m+[m
[32m+[m[32m    category, _ = Category.objects.get_or_create(name="Settings")[m
[32m+[m
[32m+[m[32m    # Ustvari produkt[m
[32m+[m[32m    product = Product.objects.create([m
[32m+[m[32m        name="Dostava",[m
[32m+[m[32m        weight=3.17,[m
[32m+[m[32m        category=category,[m
[32m+[m[32m        description="Dostava.",[m
[32m+[m[32m        settings=True[m
[32m+[m[32m    )[m
[32m+[m
[32m+[m[32m    # Ostali del (PriceTypes get_or_create)[m
[32m+[m[32m    price_type, _ = PriceTypes.objects.get_or_create([m
[32m+[m[32m        name="Settings",[m
[32m+[m[32m        defaults={[m
[32m+[m[32m            'price': 1,[m
[32m+[m[32m            'settings': True,[m
[32m+[m[32m            'description': ''[m
[32m+[m[32m        }[m
[32m+[m[32m    )[m
[32m+[m
[32m+[m[32m    try:[m
[32m+[m[32m        settings_price_type = PriceTypes.objects.get(settings=True)[m
[32m+[m[32m    except PriceTypes.DoesNotExist:[m
[32m+[m[32m        return[m
[32m+[m
[32m+[m[32m    price = product.weight[m
[32m+[m[32m    pp, created = ProductPrice.objects.update_or_create([m
[32m+[m[32m        product=product,[m
[32m+[m[32m        price_type=settings_price_type,[m
[32m+[m[32m        defaults={'price': price}[m
[32m+[m[32m    )[m
[32m+[m[32m    # Stripe sync[m
[32m+[m[32m    if not pp.stripe_product_id:[m
[32m+[m[32m        stripe_product = stripe.Product.create(name=product.name)[m
[32m+[m[32m        pp.stripe_product_id = stripe_product.id[m
[32m+[m[32m    if not pp.stripe_price_id:[m
[32m+[m[32m        stripe_price = stripe.Price.create([m
[32m+[m[32m            product=pp.stripe_product_id,[m
[32m+[m[32m            unit_amount=int(pp.price * 100),[m
[32m+[m[32m            currency="eur"[m
[32m+[m[32m        )[m
[32m+[m[32m        pp.stripe_price_id = stripe_price.id[m
[32m+[m[32m    pp.save()[m
[32m+[m
[32m+[m
[32m+[m[32mclass Migration(migrations.Migration):[m
[32m+[m
[32m+[m[32m    dependencies = [[m
[32m+[m[32m        ('store', '0033_alter_product_image'),  # popravi ime prej≈°nje migracije[m
[32m+[m[32m    ][m
[32m+[m
[32m+[m[32m    operations = [[m
[32m+[m[32m        migrations.RunPython(create_default_product),[m
[32m+[m[32m    ][m
\ No newline at end of file[m
[1mdiff --git a/store/models.py b/store/models.py[m
[1mindex 451f008..6932eaf 100644[m
[1m--- a/store/models.py[m
[1m+++ b/store/models.py[m
[36m@@ -1,5 +1,3 @@[m
[31m-from decimal import Decimal[m
[31m-[m
 from django.contrib.auth.models import User[m
 from django.db import models[m
 from django.db.models.signals import post_save[m
[1mdiff --git a/store/views.py b/store/views.py[m
[1mindex 0137f43..c49d128 100644[m
[1m--- a/store/views.py[m
[1m+++ b/store/views.py[m
[36m@@ -195,7 +195,7 @@[m [mdef update_cart(request):[m
 [m
 def cart_view(request):[m
     cart = request.session.get('cart', [])[m
[31m-    delivery_price = ProductPrice.objects.get(id=10).price[m
[32m+[m[32m    delivery_price = ProductPrice.objects.get(id=1).price[m
     total_price = 0[m
     for item in cart:[m
         item_price = float(item['price_item'])[m
